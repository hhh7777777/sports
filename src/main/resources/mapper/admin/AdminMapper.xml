<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hongyuting.sports.mapper.AdminMapper">
    <!-- Admin çš„ resultMap -->
    <resultMap id="adminResultMap" type="com.hongyuting.sports.entity.Admin">
        <id property="adminId" column="admin_id"/>
        <result property="username" column="username"/>
        <result property="password" column="password"/>
        <result property="salt" column="salt"/>
        <result property="email" column="email"/>
        <result property="roleLevel" column="role_level"/>
        <result property="department" column="department"/>
        <result property="status" column="status"/>
        <result property="createdAt" column="created_at"/>
        <result property="lastLoginTime" column="last_login_time"/>
    </resultMap>

    <insert id="insertAdmin" useGeneratedKeys="true" keyProperty="adminId">
        INSERT INTO admin (admin_id,username, password, salt, email, role_level, department, status, created_at, last_login_time)
        VALUES (#{adminId},#{username}, #{password}, #{salt}, #{email}, #{roleLevel}, #{department}, #{status}, #{createdAt}, #{lastLoginTime})
    </insert>

    <update id="updateLastLoginTime">
        UPDATE admin SET last_login_time = #{lastLoginTime} WHERE admin_id = #{adminId}
    </update>

    <update id="updatePassword">
        UPDATE admin SET password = #{password} WHERE admin_id = #{adminId}
    </update>
    
    <update id="updatePasswordAndSalt">
        UPDATE admin SET password = #{password}, salt = #{salt} WHERE admin_id = #{adminId}
    </update>

    <select id="findById" resultMap="adminResultMap">
        SELECT * FROM admin WHERE admin_id = #{adminId}
    </select>

    <select id="findByUsername" resultMap="adminResultMap">
        SELECT * FROM admin WHERE username = #{username} AND status = 1
    </select>
    
    <delete id="deleteAdmin">
        DELETE FROM admin WHERE admin_id = #{adminId}
    </delete>
    
    <select id="selectAllAdmins" resultMap="adminResultMap">
        SELECT * FROM admin
    </select>
    
    <update id="updateAdmin">
        UPDATE admin SET 
            username = #{username},
            email = #{email},
            role_level = #{roleLevel},
            department = #{department},
            status = #{status}
        WHERE admin_id = #{adminId}
    </update>
</mapper>