<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥åº·æ˜Ÿçƒ - ä½ çš„è¿åŠ¨æˆå°±ä¸–ç•Œ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/css/index.css" rel="stylesheet">
    <style>
        /* ä¸»é¡µç‰¹å®šæ ·å¼ */
        .hero-section {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 100px 0 50px;
            position: relative;
            overflow: hidden;
        }
        
        .normal-theme .hero-section {
            background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
        }
        
        .hero-tabs {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 10px;
            margin-top: 30px;
        }
        
        .hero-tab {
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .hero-tab.active, .hero-tab:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .hero-tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .hero-tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .theme-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
        }
        
        .theme-toggle-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            border-radius: 50px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .theme-toggle-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        .theme-badge {
            margin-left: 8px;
            font-weight: bold;
        }
        
        /* ç™»å½•æ³¨å†ŒåŒºåŸŸ */
        .auth-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        /* å¾½ç« åº“æ ·å¼ */
        .badge-collection {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
        }
        
        .badge-item {
            text-align: center;
            padding: 1rem;
            transition: all 0.3s ease;
        }
        
        .badge-item.owned {
            transform: scale(1.05);
        }
        
        .badge-item.locked {
            opacity: 0.6;
            filter: grayscale(1);
        }
        
        /* åŠŸèƒ½åŒºåŸŸæ ·å¼ */
        .feature-section {
            padding: 5rem 0;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            height: 100%;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            border-color: var(--christmas-gold);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .normal-theme .feature-card:hover {
            border-color: #96c93d;
        }
        
        /* é¡µè„šæ ·å¼ */
        .footer {
            background: rgba(0, 0, 0, 0.3);
            padding: 3rem 0 1rem;
            margin-top: 5rem;
        }
        
        /* ç”¨æˆ·çŠ¶æ€æ æ ·å¼ */
        .user-navbar {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            padding: 10px 0;
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 10px;
        }
        
        /* è¿”å›é¡¶éƒ¨æŒ‰é’® */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1030;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(67, 97, 238, 0.8);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .back-to-top.visible {
            opacity: 1;
        }
        
        .back-to-top:hover {
            background: rgba(67, 97, 238, 1);
            transform: translateY(-3px);
        }
        
        /* åœ£è¯æ ‘æ ·å¼ */
        .christmas-tree-container {
            height: 600px;
            position: relative;
            overflow: visible;
        }
        
        .tree {
            position: relative;
            width: 300px;
            height: 500px;
            margin: 0 auto;
        }
        
        .tree-layer {
            position: absolute;
            background: var(--christmas-green);
            border-radius: 50%;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }
        
        .tree-layer.layer-1 { 
            width: 280px; height: 100px; bottom: 0; 
            background: linear-gradient(to bottom, #0a5c36, #1e7e34);
        }
        .tree-layer.layer-2 { 
            width: 240px; height: 100px; bottom: 80px; 
            background: linear-gradient(to bottom, #0a5c36, #28a745);
        }
        .tree-layer.layer-3 { 
            width: 200px; height: 100px; bottom: 150px; 
            background: linear-gradient(to bottom, #0a5c36, #20c997);
        }
        .tree-layer.layer-4 { 
            width: 160px; height: 100px; bottom: 220px; 
            background: linear-gradient(to bottom, #0a5c36, #3ddc97);
        }
        .tree-layer.layer-5 { 
            width: 120px; height: 100px; bottom: 290px; 
            background: linear-gradient(to bottom, #0a5c36, #52de97);
        }
        
        .tree-trunk {
            position: absolute;
            width: 40px;
            height: 60px;
            background: #8B4513;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 5px;
        }
        
        .tree-star {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2.5rem;
            color: var(--christmas-gold);
            animation: twinkle 2s infinite alternate;
            filter: drop-shadow(0 0 10px gold);
        }
        
        .badge-hanger {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.3);
            border: 2px dashed var(--christmas-gold);
            cursor: pointer;
            transition: all 0.3s ease;
            animation: glow 2s infinite alternate;
        }
        
        .badge-hanger:hover {
            transform: scale(1.3);
            background: rgba(255, 215, 0, 0.8);
            animation: none;
        }
        
        .badge-hanger[data-level="5"][data-position="1"] { top: 20%; left: 35%; }
        .badge-hanger[data-level="5"][data-position="2"] { top: 20%; left: 65%; }
        .badge-hanger[data-level="4"][data-position="1"] { top: 30%; left: 30%; }
        .badge-hanger[data-level="4"][data-position="2"] { top: 30%; left: 70%; }
        .badge-hanger[data-level="3"][data-position="1"] { top: 45%; left: 25%; }
        .badge-hanger[data-level="3"][data-position="2"] { top: 45%; left: 75%; }
        .badge-hanger[data-level="2"][data-position="1"] { top: 60%; left: 20%; }
        .badge-hanger[data-level="2"][data-position="2"] { top: 60%; left: 80%; }
        .badge-hanger[data-level="1"][data-position="1"] { top: 75%; left: 15%; }
        .badge-hanger[data-level="1"][data-position="2"] { top: 75%; left: 85%; }
        
        .badge-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 3px solid transparent;
            height: 100%;
        }
        
        .badge-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        
        .badge-card.owned {
            border-color: var(--christmas-gold);
        }
        
        .badge-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 2rem;
            color: white;
            box-shadow: 0 0 15px rgba(255,255,255,0.5);
        }
        
        @keyframes twinkle {
            0% { opacity: 0.7; transform: translateX(-50%) rotate(0deg) scale(1); }
            100% { opacity: 1; transform: translateX(-50%) rotate(20deg) scale(1.1); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px gold; }
            50% { box-shadow: 0 0 20px gold; }
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .christmas-tree {
                transform: scale(0.8);
            }
            
            .tree-badge-decoration {
                transform: rotate(var(--rotation)) translate(150px);
            }
            
            .badge-wrapper:hover {
                transform: rotate(calc(var(--rotation) * -1)) scale(1.1);
            }
        }
    </style>
</head>
<body class="normal-theme">
    <!-- é¡¶éƒ¨ç”¨æˆ·çŠ¶æ€æ  -->
    <div class="user-navbar d-none" id="userNavbar">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="user-info">
                    <img src="/images/avatar/avatar.png" alt="ç”¨æˆ·å¤´åƒ" class="user-avatar" id="userAvatar">
                    <span class="text-white" id="userName">ç”¨æˆ·</span>
                </div>
                <div>
                    <a href="/" class="btn btn-sm btn-outline-light me-2">
                        <i class="fas fa-home me-1"></i>é¦–é¡µ
                    </a>
                    <a href="/dashboard" class="btn btn-sm btn-outline-light me-2">
                        <i class="fas fa-chart-line me-1"></i>æˆ‘çš„ä»ªè¡¨æ¿
                    </a>
                    <a href="/profile" class="btn btn-sm btn-outline-light me-2">
                        <i class="fas fa-user me-1"></i>ä¸ªäººèµ„æ–™
                    </a>
                    <a href="/achievements" class="btn btn-sm btn-outline-light me-2">
                        <i class="fas fa-trophy me-1"></i>æˆ‘çš„æˆå°±
                    </a>
                    <button class="btn btn-sm btn-outline-danger" id="logoutBtn">
                        <i class="fas fa-sign-out-alt me-1"></i>é€€å‡º
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ä¸»é¢˜åˆ‡æ¢å™¨ -->
    <div class="theme-switcher">
        <button class="theme-toggle-btn" id="themeToggle">
            <i class="fas fa-sun"></i>
            <span class="theme-badge" id="themeBadge">æ™®é€š</span>
        </button>
    </div>
    
    <!-- é›ªèŠ±å®¹å™¨ -->
    <div id="snowflakes"></div>
    
    <!-- é¦–é¡µä¸»ä½“ -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h1 class="display-3 fw-bold mb-3">å¥åº·æ˜Ÿçƒ</h1>
                    <p class="lead mb-4">è®°å½•æ¯ä¸€æ¬¡è¿åŠ¨ï¼Œç§¯ç´¯å¥åº·è¶³è¿¹ï¼Œè§£é”ç‹¬ç‰¹å¾½ç« ï¼Œä¸å¥½å‹ä¸€èµ·æ‰“é€ å¥åº·ç”Ÿæ´»ï¼</p>
                    <div class="d-flex gap-3">
                        <a href="/login" class="btn btn-light btn-lg" id="loginBtn">
                            <i class="fas fa-sign-in-alt me-2"></i>ç”¨æˆ·ç™»å½•
                        </a>
                        <a href="/register" class="btn btn-outline-light btn-lg" id="registerBtn">
                            <i class="fas fa-user-plus me-2"></i>æ³¨å†Œè´¦å·
                        </a>
                        <a href="/admin/login" class="btn btn-outline-light btn-lg">
                            <i class="fas fa-lock me-2"></i>ç®¡ç†å‘˜
                        </a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <!-- ä½¿ç”¨æ ‡ç­¾é¡µæ›¿ä»£è½®æ’­å›¾ -->
                    <div class="hero-tabs">
                        <div class="d-flex">
                            <button class="hero-tab active" data-tab="achievements">æˆå°±ç³»ç»Ÿ</button>
                            <button class="hero-tab" data-tab="stats">æ•°æ®ç»Ÿè®¡</button>
                            <button class="hero-tab" data-tab="challenges">æŒ‘æˆ˜æ´»åŠ¨</button>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <!-- æˆå°±ç³»ç»Ÿæ ‡ç­¾å†…å®¹ -->
                        <div class="hero-tab-content active" id="achievements-tab">
                            <div class="bg-dark p-4 rounded" style="background: rgba(0, 0, 0, 0.5);">
                                <h3><i class="fas fa-trophy me-2"></i>æˆå°±ç³»ç»Ÿ</h3>
                                <p class="mb-3">å®ŒæˆæŒ‘æˆ˜è§£é”ä¸°å¯Œå¾½ç« ï¼Œå±•ç¤ºä½ çš„è¿åŠ¨æˆæœ</p>
                                <a href="/achievements" class="btn btn-warning">æŸ¥çœ‹å¾½ç« </a>
                            </div>
                        </div>
                        
                        <!-- æ•°æ®ç»Ÿè®¡æ ‡ç­¾å†…å®¹ -->
                        <div class="hero-tab-content" id="stats-tab">
                            <div class="bg-dark p-4 rounded" style="background: rgba(0, 0, 0, 0.5);">
                                <h3><i class="fas fa-chart-line me-2"></i>æ•°æ®ç»Ÿè®¡</h3>
                                <p class="mb-3">å¯è§†åŒ–å±•ç¤ºè¿åŠ¨æ•°æ®ï¼Œè¿½è¸ªè¿›æ­¥è½¨è¿¹</p>
                                <a href="/dashboard" class="btn btn-warning">æŸ¥çœ‹è¯¦æƒ…</a>
                            </div>
                        </div>
                        
                        <!-- æŒ‘æˆ˜æ´»åŠ¨æ ‡ç­¾å†…å®¹ -->
                        <div class="hero-tab-content" id="challenges-tab">
                            <div class="bg-dark p-4 rounded" style="background: rgba(0, 0, 0, 0.5);">
                                <h3><i class="fas fa-flag me-2"></i>æŒ‘æˆ˜æ´»åŠ¨</h3>
                                <p class="mb-3">å‚ä¸ç‰¹åˆ«æ´»åŠ¨ï¼Œèµ¢å–é™å®šå¥–åŠ±</p>
                                <a href="/newyear" class="btn btn-warning">ç«‹å³å‚ä¸</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- å¾½ç« åº“åŒºåŸŸ -->
    <section id="badgeLibrary" class="py-5">
        <div class="container">
            <h3 class="text-center mb-4">ğŸŒŸ æˆ‘çš„å¾½ç« åº“</h3>
            <div class="badge-collection">
                <div class="row" id="badgeCollection">
                    <!-- å¾½ç« å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                </div>
            </div>
        </div>
    </section>
    
    <!-- åŠŸèƒ½åŒºåŸŸ -->
    <section class="feature-section bg-dark">
        <div class="container">
            <h3 class="text-center mb-5">ğŸš€ å¿«é€Ÿå¼€å§‹</h3>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="feature-card text-center">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-running fa-3x text-success"></i>
                        </div>
                        <h4>è®°å½•è¿åŠ¨</h4>
                        <p class="text-muted">è®°å½•æ¯ä¸€æ¬¡è¿åŠ¨ï¼Œç§¯ç´¯å¥åº·è¶³è¿¹</p>
                        <!-- "å¼€å§‹è®°å½•"æŒ‰é’®åº”é“¾æ¥åˆ°ç”¨æˆ·æ·»åŠ è®°å½•é¡µé¢ -->
                        <a href="/behavior" class="btn btn-outline-success mt-3">
                            <i class="fas fa-plus me-2"></i>å¼€å§‹è®°å½•
                        </a>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="feature-card text-center">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-trophy fa-3x text-warning"></i>
                        </div>
                        <h4>æŒ‘æˆ˜ä»»åŠ¡</h4>
                        <p class="text-muted">å®Œæˆç‰¹åˆ«æŒ‘æˆ˜ï¼Œè§£é”ç¨€æœ‰å¾½ç« </p>
                        <a href="/newyear" class="btn btn-outline-warning mt-3">
                            <i class="fas fa-flag me-2"></i>æŸ¥çœ‹æŒ‘æˆ˜
                        </a>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="feature-card text-center">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-users fa-3x text-info"></i>
                        </div>
                        <h4>ç¤¾åŒºåŠ¨æ€</h4>
                        <p class="text-muted">çœ‹çœ‹æœ‹å‹ä»¬çš„æˆå°±å’Œè¿›åº¦</p>
                        <!-- "åŠ å…¥ç¤¾åŒº"æŒ‰é’®åº”é“¾æ¥åˆ°ç™»å½•é¡µé¢ -->
                        <a href="/login" class="btn btn-outline-info mt-3">
                            <i class="fas fa-share-alt me-2"></i>åŠ å…¥ç¤¾åŒº
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- é¡µè„š -->
    <footer class="footer text-center">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h5><i class="fas fa-tree me-2 text-success"></i>å¥åº·æ˜Ÿçƒ</h5>
                    <p class="text-muted">è®©è¿åŠ¨å˜å¾—æœ‰è¶£ï¼Œè®©å¥åº·æˆä¸ºä¹ æƒ¯</p>
                </div>
                <div class="col-lg-4 mb-4">
                    <h5>å¿«é€Ÿé“¾æ¥</h5>
                    <div class="d-flex justify-content-center flex-wrap">
                        <a href="#badgeLibrary" class="text-decoration-none text-muted me-3">å¾½ç« åº“</a>
                        <a href="/dashboard" class="text-decoration-none text-muted me-3">æ•°æ®ç»Ÿè®¡</a>
                        <a href="/achievements" class="text-decoration-none text-muted">æˆå°±ç³»ç»Ÿ</a>
                    </div>
                </div>
                <div class="col-lg-4 mb-4">
                    <h5>è”ç³»æˆ‘ä»¬</h5>
                    <div class="social-links">
                        <a href="#" class="text-warning me-3"><i class="fab fa-weixin fa-2x"></i></a>
                        <a href="#" class="text-warning me-3"><i class="fab fa-weibo fa-2x"></i></a>
                        <a href="#" class="text-warning"><i class="fas fa-envelope fa-2x"></i></a>
                    </div>
                </div>
            </div>
            <hr class="my-4" style="border-color: rgba(255,255,255,0.1);">
            <p class="text-muted">&copy; 2025 å¥åº·æ˜Ÿçƒ. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
        </div>
    </footer>
    
    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/main.js"></script>
    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–ä¸»é¡µåº”ç”¨
            if (typeof HealthPlanetApp !== 'undefined') {
                window.app = new HealthPlanetApp();
            }
            
            // æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
            const tabs = document.querySelectorAll('.hero-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // ç§»é™¤æ‰€æœ‰æ¿€æ´»çŠ¶æ€
                    tabs.forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.hero-tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // æ¿€æ´»å½“å‰æ ‡ç­¾
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
            checkUserAuth();
            
            // ç»‘å®šè¿”å›é¡¶éƒ¨æŒ‰é’®äº‹ä»¶
            const backToTopButton = document.getElementById('backToTop');
            if (backToTopButton) {
                // æ»šåŠ¨æ—¶æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºè¿”å›é¡¶éƒ¨æŒ‰é’®
                window.addEventListener('scroll', function() {
                    if (window.scrollY > 300) {
                        backToTopButton.classList.add('visible');
                    } else {
                        backToTopButton.classList.remove('visible');
                    }
                });
                
                // ç‚¹å‡»è¿”å›é¡¶éƒ¨
                backToTopButton.addEventListener('click', function() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }
            
            // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
            const themeToggle = document.getElementById('themeToggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', function() {
                    document.body.classList.toggle('christmas-theme');
                    document.body.classList.toggle('normal-theme');
                    
                    if (document.body.classList.contains('christmas-theme')) {
                        this.innerHTML = '<i class="fas fa-snowflake"></i><span class="theme-badge">åœ£è¯</span>';
                    } else {
                        this.innerHTML = '<i class="fas fa-sun"></i><span class="theme-badge">æ™®é€š</span>';
                    }
                });
            }
        });
        
        // æ£€æŸ¥ç”¨æˆ·è®¤è¯çŠ¶æ€
        async function checkUserAuth() {
            try {
                const token = localStorage.getItem('accessToken') || sessionStorage.getItem('accessToken');
                if (!token) {
                    return;
                }
                
                const response = await fetch('/api/user/validate-token', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.code === 200) {
                        // æ˜¾ç¤ºç”¨æˆ·çŠ¶æ€æ 
                        const userNavbar = document.getElementById('userNavbar');
                        const loginBtn = document.getElementById('loginBtn');
                        const registerBtn = document.getElementById('registerBtn');
                        
                        if (userNavbar) userNavbar.classList.remove('d-none');
                        if (loginBtn) loginBtn.classList.add('d-none');
                        if (registerBtn) registerBtn.classList.add('d-none');
                        
                        // è®¾ç½®ç”¨æˆ·ä¿¡æ¯
                        if (result.data && result.data.username) {
                            // æ˜¾ç¤ºç”¨æˆ·æ˜µç§°æˆ–ç”¨æˆ·å
                            const displayName = result.data.nickname || result.data.username;
                            document.getElementById('userName').textContent = displayName;
                            
                            // æ›´æ–°ç”¨æˆ·å¤´åƒ
                            const userAvatarElements = document.querySelectorAll('.user-avatar');
                            if (result.data.avatar) {
                                userAvatarElements.forEach(el => {
                                    el.src = result.data.avatar;
                                });
                            } else {
                                userAvatarElements.forEach(el => {
                                    el.src = '/images/avatar/avatar.png';
                                });
                            }
                        }
                        
                        // ç»‘å®šé€€å‡ºæŒ‰é’®äº‹ä»¶
                        const logoutBtn = document.getElementById('logoutBtn');
                        if (logoutBtn) {
                            logoutBtn.addEventListener('click', function() {
                                logout();
                            });
                        }
                    }
                }
            } catch (error) {
                console.error('æ£€æŸ¥ç”¨æˆ·è®¤è¯çŠ¶æ€æ—¶å‡ºé”™:', error);
            }
        }
        
        // ç”¨æˆ·é€€å‡º
        async function logout() {
            try {
                const token = localStorage.getItem('accessToken') || sessionStorage.getItem('accessToken');
                if (token) {
                    await fetch('/api/user/logout', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                }
            } catch (error) {
                console.error('é€€å‡ºæ—¶å‡ºé”™:', error);
            } finally {
                // æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„ä»¤ç‰Œ
                localStorage.removeItem('accessToken');
                sessionStorage.removeItem('accessToken');
                // åˆ·æ–°é¡µé¢
                window.location.reload();
            }
        }
    </script>
</body>
</html>